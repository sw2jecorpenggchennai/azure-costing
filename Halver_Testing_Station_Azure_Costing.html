<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Halver Testing Station Azure Blob Storage Cost Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #0078d4 0%, #005a9e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 5px;
            margin-bottom: 30px;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            color: #6c757d;
        }

        .tab.active {
            background: #0078d4;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .message-analysis {
            background: #f8f9fa;
            border-left: 4px solid #0078d4;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 0 10px 10px 0;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .control-group {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .control-group input, .control-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .control-group input:focus, .control-group select:focus {
            outline: none;
            border-color: #0078d4;
            box-shadow: 0 0 0 3px rgba(0,120,212,0.1);
        }

        .data-section {
            background: #e3f2fd;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .data-section h2 {
            color: #0078d4;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .data-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #dee2e6;
            text-align: center;
            transition: transform 0.3s;
        }

        .data-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .data-value {
            font-size: 2em;
            font-weight: bold;
            color: #0078d4;
            margin: 10px 0;
        }

        .data-label {
            color: #6c757d;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .data-detail {
            color: #28a745;
            font-size: 0.9em;
            font-weight: 600;
        }

        .comparison-section {
            background: #e8f4fd;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .comparison-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #dee2e6;
            transition: transform 0.3s;
        }

        .comparison-card:hover {
            transform: translateY(-5px);
        }

        .comparison-card.individual {
            border-color: #dc3545;
        }

        .comparison-card.batch {
            border-color: #28a745;
        }

        .comparison-card h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .comparison-card.individual h3 {
            color: #dc3545;
        }

        .comparison-card.batch h3 {
            color: #28a745;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-value {
            font-weight: 600;
        }

        .batch-controls {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .batch-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .batch-option {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            border: 2px solid #ffeaa7;
            transition: all 0.3s;
        }

        .batch-option:hover {
            border-color: #0078d4;
            background: #f8f9fa;
        }

        .batch-option.selected {
            border-color: #0078d4;
            background: #e8f4fd;
        }

        .batch-size {
            font-size: 1.2em;
            font-weight: 600;
            color: #0078d4;
        }

        .batch-desc {
            font-size: 0.9em;
            color: #6c757d;
            margin-top: 5px;
        }

        .savings-highlight {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
        }

        .savings-highlight h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .savings-amount {
            font-size: 2.5em;
            font-weight: bold;
        }

        .currency-section {
            background: #f3e5f5;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .currency-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .currency-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #ce93d8;
        }

        .currency-card h4 {
            color: #7b1fa2;
            margin-bottom: 15px;
        }

        .currency-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f5f5f5;
        }

        .currency-row:last-child {
            border-bottom: none;
        }

        .operations-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .operations-table th,
        .operations-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        .operations-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }

        .operations-table tr:hover {
            background: #f8f9fa;
        }

        .alert {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            color: #6c757d;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .controls {
                grid-template-columns: 1fr;
            }
            
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📊 Halver Testing station Azure Blob Storage Cost Calculator</h1>
            <p>Complete Data Consumption Analysis with Multi-Currency Support</p>
        </div>

        <div class="content">
            <div class="tabs">
                <button class="tab active" data-tab="calculator">💰 Cost Calculator</button>
                <button class="tab" data-tab="consumption">📈 Data Consumption</button>
                <button class="tab" data-tab="currency">🌍 Multi-Currency</button>
                <button class="tab" data-tab="projection">📅 Yearly Projection</button>
            </div>

            <!-- Calculator Tab -->
            <div class="tab-content active" id="calculator">
                <div class="message-analysis">
                    <h3>📋 Message Configuration</h3>
                    <p><strong>Sample Message:</strong> <code>NOSW01,1000000,100,1,500,300,rocker,r11,r21,m111,m21,\r\n​</code></p>
                    <p><strong>Message Size:</strong> <span id="messageSize">76 bytes</span></p>
                    <p><strong>Format:</strong> connection type, cycles,temperature,onvoltage ,offvoltage,sticking number,switch test type,relay on off, motoron off</p>
                </div>

                <div class="controls">
                    <div class="control-group">
                        <label for="messageSizeInput">Message Size (bytes)</label>
                        <input type="number" id="messageSizeInput" value="76" min="1">
                    </div>
                    <div class="control-group">
                        <label for="intervalMs">Send Interval (ms)</label>
                        <input type="number" id="intervalMs" value="20" min="1" step="1">
                        <small style="color: #6c757d; font-size: 0.9em; display: block; margin-top: 5px;">
                            <span id="frequencyHelp">50 messages per second</span>
                        </small>
                    </div>
                    <div class="control-group">
                        <label for="storageType">Storage Type</label>
                        <select id="storageType">
                            <option value="hot">Hot Access Tier</option>
                            <option value="cool">Cool Access Tier</option>
                            <option value="archive">Archive Access Tier</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label for="deviceCount">Number of Devices</label>
                        <input type="number" id="deviceCount" value="1" min="1" max="1000">
                    </div>
                    <div class="control-group">
                        <label for="baseCurrency">Base Currency</label>
                        <select id="baseCurrency">
                            <option value="USD">USD (US Dollar)</option>
                            <option value="EUR">EUR (Euro)</option>
                            <option value="GBP">GBP (British Pound)</option>
                            <option value="INR">INR (Indian Rupee)</option>
                        </select>
                    </div>
                </div>

                <div class="batch-controls">
                    <h3>🎯 Select Batch Size for Comparison</h3>
                    <div class="batch-grid">
                        <div class="batch-option" data-size="1">
                            <div class="batch-size">1</div>
                            <div class="batch-desc">Individual</div>
                        </div>
                        <div class="batch-option" data-size="10">
                            <div class="batch-size">10</div>
                            <div class="batch-desc">Small</div>
                        </div>
                        <div class="batch-option" data-size="50">
                            <div class="batch-size">50</div>
                            <div class="batch-desc">Medium</div>
                        </div>
                        <div class="batch-option selected" data-size="100">
                            <div class="batch-size">100</div>
                            <div class="batch-desc">Large</div>
                        </div>
                        <div class="batch-option" data-size="500">
                            <div class="batch-size">500</div>
                            <div class="batch-desc">XL</div>
                        </div>
                    </div>
                </div>

                <div class="comparison-section">
                    <h2>💰 Cost Comparison</h2>
                    <div class="comparison-grid">
                        <div class="comparison-card individual">
                            <h3>❌ Individual Operations</h3>
                            <div class="metric">
                                <span>Operations/second:</span>
                                <span class="metric-value" id="individualOpsPerSec">50</span>
                            </div>
                            <div class="metric">
                                <span>Operations/month:</span>
                                <span class="metric-value" id="individualOpsPerMonth">129.6M</span>
                            </div>
                            <div class="metric">
                                <span>Write operations cost:</span>
                                <span class="metric-value" id="individualWriteCost">$712.80</span>
                            </div>
                            <div class="metric">
                                <span>Storage cost:</span>
                                <span class="metric-value" id="individualStorageCost">$0.17</span>
                            </div>
                            <div class="metric">
                                <span><strong>Total monthly cost:</strong></span>
                                <span class="metric-value" id="individualTotalCost"><strong>$712.97</strong></span>
                            </div>
                        </div>

                        <div class="comparison-card batch">
                            <h3>✅ Batch Operations</h3>
                            <div class="metric">
                                <span>Batch size:</span>
                                <span class="metric-value" id="batchSize">100</span>
                            </div>
                            <div class="metric">
                                <span>Operations/month:</span>
                                <span class="metric-value" id="batchOpsPerMonth">1.3M</span>
                            </div>
                            <div class="metric">
                                <span>Write operations cost:</span>
                                <span class="metric-value" id="batchWriteCost">$7.13</span>
                            </div>
                            <div class="metric">
                                <span>Storage cost:</span>
                                <span class="metric-value" id="batchStorageCost">$0.17</span>
                            </div>
                            <div class="metric">
                                <span><strong>Total monthly cost:</strong></span>
                                <span class="metric-value" id="batchTotalCost"><strong>$7.30</strong></span>
                            </div>
                        </div>
                    </div>

                    <div class="savings-highlight">
                        <h3>💵 Monthly Savings</h3>
                        <div class="savings-amount" id="monthlySavings">$705.67</div>
                        <p>That's <span id="savingsPercentage">99.0%</span> cost reduction!</p>
                    </div>
                </div>
            </div>

            <!-- Data Consumption Tab -->
            <div class="tab-content" id="consumption">
                <div class="data-section">
                    <h2>📊 Monthly Data Consumption Analysis</h2>
                    <div class="data-grid">
                        <div class="data-card">
                            <div class="data-label">Total Messages</div>
                            <div class="data-value" id="totalMessages">129.6M</div>
                            <div class="data-detail" id="messagesPerDay">4.32M/day</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">Data Volume (MB)</div>
                            <div class="data-value" id="totalDataMB">9,849</div>
                            <div class="data-detail" id="mbPerDay">328 MB/day</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">Data Volume (GB)</div>
                            <div class="data-value" id="totalDataGB">9.6</div>
                            <div class="data-detail" id="gbPerDay">0.32 GB/day</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">Bandwidth Usage</div>
                            <div class="data-value" id="bandwidthUsage">3.8 KB/s</div>
                            <div class="data-detail" id="peakBandwidth">Peak: 76 KB/s</div>
                        </div>
                    </div>
                </div>

                <div class="data-section" style="background: #fff3cd;">
                    <h2 style="color: #856404;">💾 Memory & Storage Breakdown</h2>
                    <div class="data-grid">
                        <div class="data-card">
                            <div class="data-label">Per Message</div>
                            <div class="data-value" id="singleMessage">76 B</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">Per Batch (100)</div>
                            <div class="data-value" id="batchMemory">7.6 KB</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">Per Hour</div>
                            <div class="data-value" id="hourlyMemory">13.7 MB</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">Per Day</div>
                            <div class="data-value" id="dailyMemory">329 MB</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">Per Week</div>
                            <div class="data-value" id="weeklyMemory">2.3 GB</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">Per Year</div>
                            <div class="data-value" id="yearlyMemory">117 GB</div>
                        </div>
                    </div>
                </div>

                <table class="operations-table">
                    <thead>
                        <tr>
                            <th>Batch Size</th>
                            <th>Operations/Month</th>
                            <th>Data (GB/Month)</th>
                            <th>Total Cost/Month</th>
                            <th>Savings</th>
                        </tr>
                    </thead>
                    <tbody id="operationsTableBody">
                    </tbody>
                </table>
            </div>

            <!-- Multi-Currency Tab -->
            <div class="tab-content" id="currency">
                <div class="currency-section">
                    <h2 style="color: #7b1fa2;">🌍 Multi-Currency Cost Analysis</h2>
                    <p style="margin-bottom: 20px;">Cost comparison across different currencies (2025 rates)</p>
                    
                    <div class="currency-grid" id="currencyGrid">
                    </div>
                </div>
            </div>

            <!-- Yearly Projection Tab -->
            <div class="tab-content" id="projection">
                <div class="data-section" style="background: linear-gradient(135deg, #6f42c1 0%, #e83e8c 100%); color: white;">
                    <h2 style="color: white;">📅 3-Year Cost & Data Projection</h2>
                    <div class="data-grid">
                        <div class="data-card" style="background: rgba(255,255,255,0.1); color: white;">
                            <div class="data-label" style="color: rgba(255,255,255,0.9);">2025 Annual Cost</div>
                            <div class="data-value" id="projection2025" style="color: white;">$87.60</div>
                        </div>
                        <div class="data-card" style="background: rgba(255,255,255,0.1); color: white;">
                            <div class="data-label" style="color: rgba(255,255,255,0.9);">2026 Projected</div>
                            <div class="data-value" id="projection2026" style="color: white;">$91.98</div>
                        </div>
                        <div class="data-card" style="background: rgba(255,255,255,0.1); color: white;">
                            <div class="data-label" style="color: rgba(255,255,255,0.9);">2027 Projected</div>
                            <div class="data-value" id="projection2027" style="color: white;">$96.58</div>
                        </div>
                        <div class="data-card" style="background: rgba(255,255,255,0.1); color: white;">
                            <div class="data-label" style="color: rgba(255,255,255,0.9);">3-Year Storage</div>
                            <div class="data-value" id="projectionStorage" style="color: white;">351 GB</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="alert">
                <h4>💡 Key Insights:</h4>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li><strong>Memory tracking:</strong> Complete breakdown from bytes to GB</li>
                    <li><strong>Real bandwidth:</strong> Precise calculations for network planning</li>
                    <li><strong>Storage growth:</strong> <span id="storageGrowthInsight">9.6 GB</span> monthly, <span id="yearlyGrowthInsight">117 GB</span> annually</li>
                    <li><strong>Batch optimization:</strong> Up to 99% cost reduction</li>
                    <li><strong>Multi-currency:</strong> Plan costs in your local currency</li>
                </ul>
            </div>
        </div>

        <div class="footer">
            <p>💡 Enhanced with complete data consumption tracking and multi-currency support</p>
        </div>
    </div>

    <script>
        // Simple Azure Blob Storage pricing
        const pricing = {
            hot: { storage: 0.0184, writeOps: 0.055 },
            cool: { storage: 0.01, writeOps: 0.10 },
            archive: { storage: 0.00099, writeOps: 0.11 }
        };

        // Exchange rates (2025)
        const exchangeRates = {
            USD: 1.0,
            EUR: 0.89,
            GBP: 0.77,
            INR: 82.0
        };

        let selectedBatchSize = 100;

        // Helper functions
        function formatBytes(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        function formatNumber(num) {
            if (num >= 1e9) return (num / 1e9).toFixed(1) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(1) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(1) + 'K';
            return num.toString();
        }

        function formatCurrency(amount, currency) {
            const symbols = { USD: '$', EUR: '€', GBP: '£', INR: '₹' };
            if (currency === 'INR') {
                return symbols[currency] + Math.round(amount).toLocaleString();
            }
            return symbols[currency] + amount.toFixed(2);
        }

        function updateFrequencyHelp() {
            const intervalMs = parseInt(document.getElementById('intervalMs').value);
            const messagesPerSecond = 1000 / intervalMs;
            document.getElementById('frequencyHelp').textContent = messagesPerSecond + ' messages per second';
        }

        function calculateData() {
            const messageSize = parseInt(document.getElementById('messageSizeInput').value);
            const intervalMs = parseInt(document.getElementById('intervalMs').value);
            const deviceCount = parseInt(document.getElementById('deviceCount').value);
            
            const messagesPerSecond = (1000 / intervalMs) * deviceCount;
            const messagesPerDay = messagesPerSecond * 86400;
            const messagesPerMonth = messagesPerDay * 30;
            const messagesPerYear = messagesPerDay * 365;
            
            const bytesPerSecond = messagesPerSecond * messageSize;
            const bytesPerHour = messagesPerSecond * 3600 * messageSize;
            const bytesPerDay = messagesPerDay * messageSize;
            const bytesPerMonth = messagesPerMonth * messageSize;
            const bytesPerYear = messagesPerYear * messageSize;
            
            const mbPerMonth = bytesPerMonth / (1024 * 1024);
            const gbPerMonth = mbPerMonth / 1024;
            const mbPerDay = bytesPerDay / (1024 * 1024);
            const gbPerDay = mbPerDay / 1024;
            
            return {
                messagesPerSecond, messagesPerDay, messagesPerMonth, messagesPerYear,
                bytesPerSecond, bytesPerHour, bytesPerDay, bytesPerMonth, bytesPerYear,
                mbPerMonth, gbPerMonth, mbPerDay, gbPerDay, messageSize
            };
        }

        function updateDisplay() {
            const data = calculateData();
            const storageType = document.getElementById('storageType').value;
            const baseCurrency = document.getElementById('baseCurrency').value;
            const currentPricing = pricing[storageType];
            const exchangeRate = exchangeRates[baseCurrency];
            
            updateFrequencyHelp();
            
            // Update data consumption display
            document.getElementById('totalMessages').textContent = formatNumber(data.messagesPerMonth);
            document.getElementById('messagesPerDay').textContent = formatNumber(data.messagesPerDay) + '/day';
            document.getElementById('totalDataMB').textContent = formatNumber(data.mbPerMonth);
            document.getElementById('mbPerDay').textContent = Math.round(data.mbPerDay) + ' MB/day';
            document.getElementById('totalDataGB').textContent = data.gbPerMonth.toFixed(1);
            document.getElementById('gbPerDay').textContent = data.gbPerDay.toFixed(2) + ' GB/day';
            document.getElementById('bandwidthUsage').textContent = formatBytes(data.bytesPerSecond) + '/s';
            document.getElementById('peakBandwidth').textContent = 'Peak: ' + formatBytes(data.messageSize * data.messagesPerSecond) + '/s';
            
            // Update memory breakdown
            document.getElementById('singleMessage').textContent = formatBytes(data.messageSize);
            document.getElementById('batchMemory').textContent = formatBytes(data.messageSize * selectedBatchSize);
            document.getElementById('hourlyMemory').textContent = formatBytes(data.bytesPerHour);
            document.getElementById('dailyMemory').textContent = formatBytes(data.bytesPerDay);
            document.getElementById('weeklyMemory').textContent = formatBytes(data.bytesPerDay * 7);
            document.getElementById('yearlyMemory').textContent = formatBytes(data.bytesPerYear);
            
            // Calculate costs
            const storageCost = data.gbPerMonth * currentPricing.storage;
            
            // Individual operations
            const individualOpsPerMonth = data.messagesPerMonth;
            const individualWriteCost = (individualOpsPerMonth / 10000) * currentPricing.writeOps;
            const individualTotalCost = individualWriteCost + storageCost;
            
            // Batch operations
            const batchOpsPerMonth = data.messagesPerMonth / selectedBatchSize;
            const batchWriteCost = (batchOpsPerMonth / 10000) * currentPricing.writeOps;
            const batchTotalCost = batchWriteCost + storageCost;
            
            // Calculate savings
            const monthlySavings = individualTotalCost - batchTotalCost;
            const savingsPercentage = (monthlySavings / individualTotalCost) * 100;
            
            // Update cost comparison
            document.getElementById('individualOpsPerSec').textContent = formatNumber(data.messagesPerSecond);
            document.getElementById('individualOpsPerMonth').textContent = formatNumber(individualOpsPerMonth);
            document.getElementById('individualWriteCost').textContent = formatCurrency(individualWriteCost * exchangeRate, baseCurrency);
            document.getElementById('individualStorageCost').textContent = formatCurrency(storageCost * exchangeRate, baseCurrency);
            document.getElementById('individualTotalCost').textContent = formatCurrency(individualTotalCost * exchangeRate, baseCurrency);
            
            document.getElementById('batchSize').textContent = selectedBatchSize.toLocaleString();
            document.getElementById('batchOpsPerMonth').textContent = formatNumber(batchOpsPerMonth);
            document.getElementById('batchWriteCost').textContent = formatCurrency(batchWriteCost * exchangeRate, baseCurrency);
            document.getElementById('batchStorageCost').textContent = formatCurrency(storageCost * exchangeRate, baseCurrency);
            document.getElementById('batchTotalCost').textContent = formatCurrency(batchTotalCost * exchangeRate, baseCurrency);
            
            document.getElementById('monthlySavings').textContent = formatCurrency(monthlySavings * exchangeRate, baseCurrency);
            document.getElementById('savingsPercentage').textContent = savingsPercentage.toFixed(1) + '%';
            
            // Update message size
            document.getElementById('messageSize').textContent = data.messageSize + ' bytes';
            
            // Update insights
            document.getElementById('storageGrowthInsight').textContent = data.gbPerMonth.toFixed(1) + ' GB';
            document.getElementById('yearlyGrowthInsight').textContent = (data.gbPerMonth * 12).toFixed(1) + ' GB';
            
            // Update operations table
            updateOperationsTable(data, currentPricing, exchangeRate, baseCurrency);
            
            // Update currency analysis
            updateCurrencyAnalysis(data, currentPricing);
            
            // Update projections
            updateProjections(data, currentPricing, exchangeRate, baseCurrency);
        }

        function updateOperationsTable(data, currentPricing, exchangeRate, baseCurrency) {
            const storageCost = data.gbPerMonth * currentPricing.storage;
            const batchSizes = [1, 10, 50, 100, 500];
            const tableBody = document.getElementById('operationsTableBody');
            
            const individualOpsPerMonth = data.messagesPerMonth;
            const individualWriteCost = (individualOpsPerMonth / 10000) * currentPricing.writeOps;
            const individualTotalCost = individualWriteCost + storageCost;
            
            tableBody.innerHTML = '';
            
            batchSizes.forEach(batchSize => {
                const opsPerMonth = data.messagesPerMonth / batchSize;
                const writeCost = (opsPerMonth / 10000) * currentPricing.writeOps;
                const totalCost = writeCost + storageCost;
                const savings = individualTotalCost - totalCost;
                const savingsPercent = (savings / individualTotalCost) * 100;
                
                const row = tableBody.insertRow();
                row.innerHTML = `
                    <td>${batchSize === 1 ? 'Individual' : batchSize.toLocaleString()}</td>
                    <td>${formatNumber(opsPerMonth)}</td>
                    <td>${data.gbPerMonth.toFixed(2)}</td>
                    <td>${formatCurrency(totalCost * exchangeRate, baseCurrency)}</td>
                    <td>${savings > 0 ? formatCurrency(savings * exchangeRate, baseCurrency) + ' (' + savingsPercent.toFixed(1) + '%)' : '-'}</td>
                `;
                
                if (batchSize === selectedBatchSize) {
                    row.style.backgroundColor = '#e8f4fd';
                    row.style.fontWeight = 'bold';
                }
            });
        }

        function updateCurrencyAnalysis(data, currentPricing) {
            const storageCost = data.gbPerMonth * currentPricing.storage;
            const batchOpsPerMonth = data.messagesPerMonth / selectedBatchSize;
            const batchWriteCost = (batchOpsPerMonth / 10000) * currentPricing.writeOps;
            const batchTotalCostUSD = batchWriteCost + storageCost;
            
            const currencyGrid = document.getElementById('currencyGrid');
            currencyGrid.innerHTML = '';
            
            Object.keys(exchangeRates).forEach(currency => {
                const rate = exchangeRates[currency];
                const totalCostLocal = batchTotalCostUSD * rate;
                const annualCostLocal = totalCostLocal * 12;
                
                const currencyCard = document.createElement('div');
                currencyCard.className = 'currency-card';
                currencyCard.innerHTML = `
                    <h4>${currency}</h4>
                    <div class="currency-row">
                        <span>Exchange Rate:</span>
                        <span>${rate.toFixed(currency === 'INR' ? 0 : 3)}</span>
                    </div>
                    <div class="currency-row">
                        <span>Monthly Cost:</span>
                        <span><strong>${formatCurrency(totalCostLocal, currency)}</strong></span>
                    </div>
                    <div class="currency-row">
                        <span>Annual Cost:</span>
                        <span><strong>${formatCurrency(annualCostLocal, currency)}</strong></span>
                    </div>
                    <div class="currency-row">
                        <span>Data Volume:</span>
                        <span>${data.gbPerMonth.toFixed(1)} GB/month</span>
                    </div>
                `;
                currencyGrid.appendChild(currencyCard);
            });
        }

        function updateProjections(data, currentPricing, exchangeRate, baseCurrency) {
            const monthlyStorageCost = data.gbPerMonth * currentPricing.storage;
            const batchOpsPerMonth = data.messagesPerMonth / selectedBatchSize;
            const monthlyWriteCost = (batchOpsPerMonth / 10000) * currentPricing.writeOps;
            const monthlyTotalCost = monthlyWriteCost + monthlyStorageCost;
            
            const inflationFactors = { 2025: 1.0, 2026: 1.05, 2027: 1.10 };
            
            const projection2025 = monthlyTotalCost * 12 * inflationFactors[2025] * exchangeRate;
            const projection2026 = monthlyTotalCost * 12 * inflationFactors[2026] * exchangeRate;
            const projection2027 = monthlyTotalCost * 12 * inflationFactors[2027] * exchangeRate;
            
            document.getElementById('projection2025').textContent = formatCurrency(projection2025, baseCurrency);
            document.getElementById('projection2026').textContent = formatCurrency(projection2026, baseCurrency);
            document.getElementById('projection2027').textContent = formatCurrency(projection2027, baseCurrency);
            document.getElementById('projectionStorage').textContent = formatBytes(data.bytesPerYear * 3);
        }

        // Tab functionality
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const targetTab = this.dataset.tab;
                
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(targetTab).classList.add('active');
            });
        });

        // Event listeners
        document.getElementById('messageSizeInput').addEventListener('input', updateDisplay);
        document.getElementById('intervalMs').addEventListener('input', updateDisplay);
        document.getElementById('storageType').addEventListener('change', updateDisplay);
        document.getElementById('deviceCount').addEventListener('input', updateDisplay);
        document.getElementById('baseCurrency').addEventListener('change', updateDisplay);

        // Batch size selection
        document.querySelectorAll('.batch-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.batch-option').forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                selectedBatchSize = parseInt(this.dataset.size);
                updateDisplay();
            });
        });

        // Initial calculation
        updateDisplay();
    </script>
</body>
</html>